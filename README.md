# NoSQL-Practice

NoSQL作业报告

一、	经济情况分析
1）	问题描述
根据作业要求及所提供数据需得出以下三个问题的结果：
a 经济是否处于通货膨胀？
b	经济是否过热？
c	失业是否在加剧？
提供的数据：
文件名	包含字段
CPI.csv 指标代码,指标全称,数据发布时间,数据日期,数据值,单位,地区,数据来源,数据更新时间
GDP.csv 指标代码,指标全称,数据发布时间,数据日期,数据值,单位,地区,来源,数据更新时间
PMI.csv 指标代码,指标全称,数据发布时间,数据日期,数据值,单位,地区,数据来源,数据更新时间
美国GDP.csv 指标代码,指标全称,数据发布时间,数据日期,数据值,单位,地区,数据来源,数据更新时间
美国就业与失业.csv  指标代码,指标全称,数据发布时间,数据日期,数据值,单位,地区,数据来源,数据更新时间

任务描述：
利用所学到的NoSQL技术，加载并进行数据处理，包括：
  经济是否处于通膨？
    当CPI>3%时，我们称为INFLATION，就是通货膨胀；
    CPI>5%的增幅时，称为SERIOUS INFLATION，就是严重通货膨胀。
    经济是否过热？
    CPI/PPI上涨（过高），一般是经济偏热（过热）的表面特征
    PMI与上月进行比较，大于50%，表示经济上升，反之则趋向下降。
  失业是否在加剧？
    统计每个季度的农业和非农业失业率以及其变化
	要求：
    在MongoDB上实现

实现说明：
  编写将数据载入Mongodb的JAVA程序，实现命令行执行导入程序。例如：java –jar NoSQL.jar –a ImportDataToMongodb –p /home/tianwen/bigdata/，-a参数表示指定行为，ImportDataToMongodb表示将数据导入mongodb行为，-p表示指定数据目录，后面跟目录地址。
  编写分析经济形势的命令行程序，实现按日期查询数据的功能。例如：java –jar NoSQL.jar –a EconomicSituation –d 2014-08-31，表示显示2014-08-31的经济情况。-d表示指定日期参数，后面跟要查询的日期。

算法：
  第一个问题可根据CPI数据直接得出指定日期是否处于通货膨胀，即CPI>3时通货膨胀，CPI>5时严重通货膨胀。
  第二个问题由于数据中没有PPI数据，无法得出经济是否处于过热还是过高，只能通过已有PMI数据得出经济趋于上升或下降，即PMI大于50%表示趋于上升，反之趋于下降。
  第三个问题由于数据只有美国2014年失业数据，所以只能基于美国失业数据计算。公式为失业变化率等于当月失业率减去上月失业率除以上月失业率。大于0表示失业率上升，小于零表示失业率下降，等于0表示不变。因为没有可参考的失业率变化快慢指标，所以本作业中将假设失业率变化率的绝对值大于2%为变化较快，否则表示变化缓慢。另外失业率是否偏高参考了网上资料，当失业率大于5%表示偏高，大于4小于5表示略高，小于等于4表示正常。

2）	数据加载代码
  ImportDataToMongodb.java
3）	数据统计代码
  EconomicSituation.java
4）	操作及分析结果
  将csv数据导入mongodb操作：
  java -jar NoSQL.jar -a ImportDataToMongodb -p /home/tianwen/Documents/bigdata/
  2016-09-21 11:02:01 导入数据开始
  2016-09-21 11:02:03 导入数据完成

  查指定日期的经济情况操作：
  java -jar -a EconomicSituation -d 2014-09-30
  2016-09-21 10:59:54 输出结果：
  中国经济CPI为2.15,不通胀，PMI为51.2，趋于上升。
  美国失业率是5.9%，偏高，环比下降3.28%，变化较快。

二、	微博数据分析
1）	问题描述
  给出sql数据文件weibodatabase.sql，导入到本地mysql数据库中，过程如下：
    部署mysql（细节略）
    进入mysql，新建weibo数据库，SQL：create database weibo。
    导入数据。SQL：Set names utf8;Source /home/tianwen/Documents/weibodatabase.sql;

数据描述如下：
数据表	字段
新浪微博用户信息	用户uid，用户昵称，用户姓名，用户所在地，用户主页url，
用户性别，用户粉丝数，用户关注数，用户微博数，用户收藏数，用户创建时间
新浪微博信息	微博mid，发布时间，微博内容，微博来源，微博转发数，微
博评论数，微博被赞数，发表用户uid，微博所属主题。
12个主题包括魅族，小米，火箭队，林书豪，恒大，韩剧，雾霾，房价，同桌的你，公务员，贪官，转基因。
新浪微博用户好友关系	每条记录由suid和tuid两个字段组成，表示suid关注tuid，由于新浪微博的限制，每个用户最多只能获取到200个关注人的信息，故好友关系不是很全；
新浪微博转发关系	每条记录由smid和tmid两个字段组成，表示smid微博转发tmid微博。

根据作业要求和提供数据需要得出以下5个问题的结果：
a.	找出发帖子最多的5个用户？
b.	找出转发次数最多的20个帖子？
c.	找出最热门的3个话题？
d.	找出具有最多相同好友的5对用户？
e.	找出转发最多相同帖子的5对用户？

2）	数据加载代码
  ImportWeiboDataToRedis.java
  DataLoader.java
  MysqlHandler.java
  RedisHandler.java
3）	数据统计代码
  WeiboData.java
4）	操作及结果
  将微博数据导入到redis操作：
  java -jar NoSQL.jar -a ImportWeiboDataToRedis
  2016-09-21 11:04:37 导入数据开始
  2016-09-21 11:05:59 导入数据完成

  查看发帖数量最多的5个用户操作：
  java -jar NoSQL.jar -a FaTieUsersTop5
  发帖最多用户TOP5如下：
  用户ID	用户名	发帖数量
  1638781994	新浪体育	162
  1638782947	新浪财经	113
  2803301701	人民日报	100
  1883881851	NBA	94
  1693168330	黑白无道灰有道	91
  2656274875	央视新闻	91

  查看转发次数最多的20个微博：
  java -jar NoSQL.jar -a ZhuanFaWeibosTop20
  转发最多的微博TOP20如下：
  微博ID	微博内容	转发次数
  3706807731643105	#下载九乐棋牌，免费拿ipad mini#天上从来不会掉馅饼，但马上就掉土豪金！动动手指的功夫，ipad mini到手了。即日起下载九乐棋牌，转发本微博并@三个好友，就有机会获得ipad mini  一部。小伙伴们都惊呆了，还等什么？赶紧过来参与吧！ http://t.cn/8sBsPjK	1482738
  ...(略)

  查看最热门的话题操作：
  java -jar NoSQL.jar -a HotTopicsTop3
  最热门主题TOP3如下：
  主题	评论数
  小米	1360412
  公务员	678180
  同桌的你	661518

  查看拥有最多相同好友的用户对操作：
  java -jar NoSQL.jar -a HaveSameFriendsUserPairsTop5
  拥有相同朋友最多的用户对TOP5如下：
  用户1	用户2	拥有相同朋友数量
  老瑞读报	Runner童	55
  老瑞读报	缇萦淳于	55
  老瑞读报	黑暗的一大朝	51
  网络舆情分析师	人民日报	50
  camle-luo	报人柳眉	50

  查看转发相同微博最多的用户对操作：
  java -jar NoSQL.jar -a RepostSameWeibosUserPairsTop5
  转发相同微博最多的用户对TOP5如下：
  用户1	用户2	转发相同微博数量
  黑白无道灰有道	顾秀林的微博	6
  多多dddd	行走于苍茫大地	5
  曹明华和曹明逸	笨笨鼠2011	5
  顾秀林的微博	编剧赵华	5
  顾秀林的微博	Overbluesky	5

三、	上面两个数据结果通过Web界面查询
1）	问题描述
  基于上面工作，制作web页面，能通过页面上的表单查询经济情况和微博数据。

2）	数据加载代码
  数据已加载，此处不需要另外加载。

3）	数据统计代码
  index.jsp (数据查询页面)
  FormHandle.java（接受查询的Servlet类）

4）	分析结果及解释
  中国经济CPI为2.21，不通胀，PMI为51.9，趋于上升。
  美国失业率是6.1%，偏高，环比下降1.61%,变化缓慢。

  用户ID	用户名	发帖数量
  1638781994	新浪体育	162
  1638782947	新浪财经	113
  2803301701	人民日报	100
  1883881851	NBA	94
  1693168330	黑白无道灰有道	91
  2656274875	央视新闻	91
