# NoSQL-Practice

NoSQL作业报告

一、	经济情况分析
1）	问题描述
根据作业要求及所提供数据需得出以下三个问题的结果：
	经济是否处于通货膨胀？
	经济是否过热？
	失业是否在加剧？
提供的数据：
文件名	包含字段
CPI.csv	指标代码,指标全称,数据发布时间,数据日期,数据值,单位,地区,数据来源,数据更新时间
GDP.csv	指标代码,指标全称,数据发布时间,数据日期,数据值,单位,地区,来源,数据更新时间
PMI.csv	指标代码,指标全称,数据发布时间,数据日期,数据值,单位,地区,数据来源,数据更新时间
美国GDP.csv	指标代码,指标全称,数据发布时间,数据日期,数据值,单位,地区,数据来源,数据更新时间
美国就业与失业.csv	指标代码,指标全称,数据发布时间,数据日期,数据值,单位,地区,数据来源,数据更新时间

任务描述：
	利用所学到的NoSQL技术，加载并进行数据处理，包括：
 经济是否处于通膨？
 当CPI>3%时，我们称为INFLATION，就是通货膨胀；
 CPI>5%的增幅时，称为SERIOUS INFLATION，就是严重通货膨胀。
 经济是否过热？
 CPI/PPI上涨（过高），一般是经济偏热（过热）的表面特征
 PMI与上月进行比较，大于50%，表示经济上升，反之则趋向下降。
 失业是否在加剧？
 统计每个季度的农业和非农业失业率以及其变化
	要求：
 在MongoDB上实现

实现说明：
	编写将数据载入Mongodb的JAVA程序，实现命令行执行导入程序。例如：java –jar NoSQL.jar –a ImportDataToMongodb –p /home/tianwen/bigdata/，-a参数表示指定行为，ImportDataToMongodb表示将数据导入mongodb行为，-p表示指定数据目录，后面跟目录地址。
编写分析经济形势的命令行程序，实现按日期查询数据的功能。例如：java –jar NoSQL.jar –a EconomicSituation –d 2014-08-31，表示显示2014-08-31的经济情况。-d表示指定日期参数，后面跟要查询的日期。

	算法
	第一个问题可根据CPI数据直接得出指定日期是否处于通货膨胀，即CPI>3时通货膨胀，CPI>5时严重通货膨胀；
	第二个问题由于数据中没有PPI数据，无法得出经济是否处于过热还是过高，只能通过已有PMI数据得出经济趋于上升或下降，即PMI大于50%表示趋于上升，反之趋于下降；
	第三个问题由于数据只有美国2014年失业数据，所以只能基于美国失业数据计算。公式为失业变化率等于当月失业率减去上月失业率除以上月失业率。大于0表示失业率上升，小于零表示失业率下降，等于0表示不变。因为没有可参考的失业率变化快慢指标，所以本作业中将假设失业率变化率的绝对值大于2%为变化较快，否则表示变化缓慢。另外失业率是否偏高参考了网上资料，当失业率大于5%表示偏高，大于4小于5表示略高，小于等于4表示正常。

2）	数据加载代码
ImportDataToMongodb.java
3）	数据统计代码
EconomicSituation.java
4）	操作及分析结果
将csv数据导入mongodb操作：
java -jar NoSQL.jar -a ImportDataToMongodb -p /home/tianwen/Documents/bigdata/
2016-09-21 11:02:01 导入数据开始
2016-09-21 11:02:03 导入数据完成

查指定日期的经济情况操作：
java -jar -a EconomicSituation -d 2014-09-30
2016-09-21 10:59:54 输出结果：
中国经济CPI为2.15,不通胀，PMI为51.2，趋于上升。
美国失业率是5.9%，偏高，环比下降3.28%，变化较快。

二、	微博数据分析
1）	问题描述
给出sql数据文件weibodatabase.sql，导入到本地mysql数据库中，过程如下：
	部署mysql（细节略）
	进入mysql，新建weibo数据库，SQL：create database weibo。
	导入数据。SQL：Set names utf8;Source /home/tianwen/Documents/weibodatabase.sql;

数据描述如下：
数据表	字段
新浪微博用户信息	用户uid，用户昵称，用户姓名，用户所在地，用户主页url，
用户性别，用户粉丝数，用户关注数，用户微博数，用户收藏数，用户创建时间
新浪微博信息	微博mid，发布时间，微博内容，微博来源，微博转发数，微
博评论数，微博被赞数，发表用户uid，微博所属主题。
12个主题包括魅族，小米，火箭队，林书豪，恒大，韩剧，雾霾，房价，同桌的你，公务员，贪官，转基因。
新浪微博用户好友关系	每条记录由suid和tuid两个字段组成，表示suid关注tuid，由于新浪微博的限制，每个用户最多只能获取到200个关注人的信息，故好友关系不是很全；
新浪微博转发关系	每条记录由smid和tmid两个字段组成，表示smid微博转发tmid微博。

根据作业要求和提供数据需要得出以下5个问题的结果：
	找出发帖子最多的5个用户？
	找出转发次数最多的20个帖子？
	找出最热门的3个话题？
	找出具有最多相同好友的5对用户？
	找出转发最多相同帖子的5对用户？

2）	数据加载代码
ImportWeiboDataToRedis.java
DataLoader.java
MysqlHandler.java
RedisHandler.java
3）	数据统计代码
WeiboData.java
4）	操作及结果
将微博数据导入到redis操作：
java -jar NoSQL.jar -a ImportWeiboDataToRedis
2016-09-21 11:04:37 导入数据开始
2016-09-21 11:05:59 导入数据完成

查看发帖数量最多的5个用户操作：
java -jar NoSQL.jar -a FaTieUsersTop5
发帖最多用户TOP5如下：
用户ID	用户名	发帖数量
1638781994	新浪体育	162
1638782947	新浪财经	113
2803301701	人民日报	100
1883881851	NBA	94
1693168330	黑白无道灰有道	91
2656274875	央视新闻	91

查看转发次数最多的20个微博：
java -jar NoSQL.jar -a ZhuanFaWeibosTop20
转发最多的微博TOP20如下：
微博ID	微博内容	转发次数
3706807731643105	#下载九乐棋牌，免费拿ipad mini#天上从来不会掉馅饼，但马上就掉土豪金！动动手指的功夫，ipad mini到手了。即日起下载九乐棋牌，转发本微博并@三个好友，就有机会获得ipad mini  一部。小伙伴们都惊呆了，还等什么？赶紧过来参与吧！ http://t.cn/8sBsPjK	1482738
3601828383872686	【本王法力无边，关注并转我子孙锦鲤图者，一月内必有好事发生】	1188415
3707517656090227	中国好制造，造就好平板cs1。世界知名品牌，多是made in china，其中，富士康以严格的生产流程，精湛的工艺，享誉全球。富士康制造的infocus品牌，以超高工艺及性价比，面世啦。参与#你知道富士康为哪些品牌代工过吗#的话题，有机会抽中平板电脑和耳机！ http://t.cn/8sd8FeR	851393
3707926776326791	#《暗黑战神》发号 转发送小米2S#3D手游《暗黑战神》震撼来袭！畅享连击快感，邀你体验！即日起转发微博@ 3名好友，即有机会赢取小米2S！此外，关注安卓网微信(Hiapk2013),回复：“暗黑战神”即可获取专属礼包！下载地址>>>http://t.cn/8sgHrdx http://t.cn/8sgmy1X	805500
3706808889444156	【#小米路由器#微博开卖 预约送10台】5月8日中午12点，5000台高！大！上！小米路由器开卖：顶配双频AC智能路由器，上网快3倍，内置1TB硬盘，小型家庭服务器，仅售699元。预约方法：点击『参与』→『立即预约』，即可获得购买资格。转发每天送出2台路由器。 http://t.cn/8sBstBm	464520
3677191939836259	大家好！我刚从火星回到地球，我将以最开放的心去包容，去接纳这个世界。大家都知道我们营销做的烂，从今天开始，我就要告诉更多人知道，除了小米手机之外，还有更好的魅族手机可以选择。	372509
3707697826021836	【#小时代3#先导预告】“这是最好的时代，也是最坏的时代。你会忘记这个时代，但你，会永远记住我们。”又是一年盛夏了，期待与你们的#小时代717重逢之期# 。——远处传来导演戴着氧气罩的呐喊：“……敬请期待，时代姐妹花环球作死大作战……”http://t.cn/8sgqypD	271087
3708771295266472	还有一个月就要中考了，最近复习真累呀，所以我要劳逸结合下 [馋嘴]，马上又要看书了 [抓狂]！	243069
3707879418660827	#华为Ascend P7首发预约赢大礼# 即日起-5月12日18:00，来@华为商城 免费预约，参与首发购机即有丰厚大奖等你拿！华为Ascend P7手机（共30台）、背夹电池（300台）。预约猛戳（http://t.cn/8sgW8sC）转发微博再送一台华为Ascend P7手机。惊喜连连，不容错过！ http://t.cn/8sgl4M0	236406
3707609351629615	【400万强势围观，40部荣耀3C狂送！】#转发400万，40部荣耀3C疯狂送#即日起至5月15日，转发本微博，每转发10万次即送荣耀3C一部，最高狂送40部！5月15日，#耀你好看#，好消息告诉大家~	210975
3706539196540496	【福利帖！转发送小米发布会门票】小米将于5月15日在北京召开新品发布会，小米3S、小米电视2均有望亮相。门票价值199元，限量500张，到会或可获赠3S(去年红米)。关注@驱动之家 ，转发此微博并@ 三位好友，就有机会赢得超值门票一张！转发越多机会越大！ http://t.cn/8sBJrjH	209672
3705811903299246	狗对人的忠诚超越了我的想象，我把狗作为朋友，我不食狗肉，我反对以狗肉为食。狗狗	185721
3707955046057848	3D动作手机网游《暗黑战神》震撼来袭！超强画面质感，畅享连击快感！尝鲜体验请狂戳>>：http://t.cn/8sgHrdx  新浪微博转发送即送小米2s、50元京东卡！回复"暗黑战神"至安卓市场微信公众平台（ID：1648694884）领取惊喜礼包，奖品多多，今天你领奖了么？ http://t.cn/8sgrDFV	183380
3700040272544613	哈哈哈哈哈哈哈太扯蛋了！哈哈哈哈http://t.cn/8sOxtkV 	178130
3705357794362205	五一小长假，大神送好礼！即日起至5月6日，关注@神得强Steven @MIUI发烧友俱乐部 并转发此微博，分别送出小米路由器1台，60cm米兔抱枕2个，小米彩色移动电源5个，红米Note F码10个。永远相信美好的事情即将发生，祝大家度过一个愉快的假期！	170766
3707707867187202	#4G智拍旗舰Xshot#【天猫全球首发•转发送Xshot】vivo Xshot震撼发布，采用骁龙801（8974AC）处理器，3G RAM+32G ROM，配备顶级Hi-Fi芯片，搭载Funtouch OS 1.2，F1.8光圈+光学防抖，支持4K视频录制。vivo天猫旗舰店全球首发，立即0元预约： http://t.cn/8sdB2iU。5月12日前，转发微博，随机送5台Xshot	168647
3448811278489063	六个月前我女儿早上课间在教学楼女厕遭猥亵虐杀。凶手之前至少猥亵过6名女生，而凶手竟然说觉得小姐脏，所以才对学生下手。而他律师说他没有造成恶劣的社会影响，求法院轻判。详见：http://t.cn/zOEINBb及女儿男友做的视频：http://t.cn/zO1qhsQ为父能做的不多，实名认证，为内容真实性负责！	166866
3708332391343086	【#红米Note#增强版首发 转发送出15个F码】5月13日中午12点，红米Note增强版小米网首卖，999元可选移动/联通版！真八核1.7GHz处理器，2GB内存，5.5英寸高清IPS大屏，1300万像素背照式相机，3200mAh大容量电池……全新八核性价比之王，立即预约→http://t.cn/zRJ5Spw。12日前转发每天送出5个增强版F码！	164777
3707322868047449	啊…这几天天气好好，感觉春天还没过完夏天就来了。今天放学的时候看到路旁绿油油的一片，然后！忍不住一找，猜我发现了什么！四叶草耶！[哈哈]	157107
3708292892926965	【微博购MX3送耳机 转发预约送6台】5月12日中午12点，魅族MX3在微博平台再次开卖，预约购机并下单，即可获赠EP21耳机一副。仅售1799元，即刻感受更好用的大屏手机带来的极致体验。点击马上参与，转发每天送出一台MX3，开卖当日下单即得耳机。 http://t.cn/8seljHB	141810

查看最热门的话题操作：
java -jar NoSQL.jar -a HotTopicsTop3
最热门主题TOP3如下：
主题	评论数
小米	1360412
公务员	678180
同桌的你	661518

查看拥有最多相同好友的用户对操作：
java -jar NoSQL.jar -a HaveSameFriendsUserPairsTop5
拥有相同朋友最多的用户对TOP5如下：
用户1	用户2	拥有相同朋友数量
老瑞读报	Runner童	55
老瑞读报	缇萦淳于	55
老瑞读报	黑暗的一大朝	51
网络舆情分析师	人民日报	50
camle-luo	报人柳眉	50

查看转发相同微博最多的用户对操作：
java -jar NoSQL.jar -a RepostSameWeibosUserPairsTop5
转发相同微博最多的用户对TOP5如下：
用户1	用户2	转发相同微博数量
黑白无道灰有道	顾秀林的微博	6
多多dddd	行走于苍茫大地	5
曹明华和曹明逸	笨笨鼠2011	5
顾秀林的微博	编剧赵华	5
顾秀林的微博	Overbluesky	5

三、	上面两个数据结果通过Web界面查询
1）	问题描述
基于上面工作，制作web页面，能通过页面上的表单查询经济情况和微博数据。

2）	数据加载代码
数据已加载，此处不需要另外加载。

3）	数据统计代码
index.jsp (数据查询页面)
FormHandle.java（接受查询的Servlet类）

4）	分析结果及解释
中国经济CPI为2.21，不通胀，PMI为51.9，趋于上升。
美国失业率是6.1%，偏高，环比下降1.61%,变化缓慢。

用户ID	用户名	发帖数量
1638781994	新浪体育	162
1638782947	新浪财经	113
2803301701	人民日报	100
1883881851	NBA	94
1693168330	黑白无道灰有道	91
2656274875	央视新闻	91
